	
	<ui:composition xmlns:f="http://java.sun.com/jsf/core"
xmlns:ui="http://java.sun.com/jsf/facelets"
xmlns:h="http://java.sun.com/jsf/html"
xmlns:p="http://primefaces.org/ui"
template="template.xhtml">
<ui:define name="content">
		
		
		<div id="maPage" class="div_body">
			<h1><h:outputText value="#{msgs['AVIS.TITLE.HISTO']}" /></h1>
			<div class="messageForUser">
				<p:message id="messages" showDetail="true" autoUpdate="true" />
			</div>
			<ui:fragment rendered="#{opinionController.actionEnum.whatAction != 
				opinionController.actionEnum.propositionAction}">
				<h:outputText value="#{msgs['FIELD_LABEL.AVIS.STUDENT']}" 
					styleClass="section-subheader"/>
				<h:outputText value="#{opinionController.indVoeuxPojo.indVoeu.individu.nomPatronymique} 
					#{opinionController.indVoeuxPojo.indVoeu.individu.prenom} 
					(#{opinionController.indVoeuxPojo.indVoeu.individu.numDossierOpi})"/>
				<br />
				<br />
				<h:outputText value="#{msgs['FIELD_LABEL.AVIS.ETAPE']}" 
					styleClass="section-subheader"/>
				<h:outputText value="#{opinionController.indVoeuxPojo.vrsEtape.libWebVet}"/>
			</div>
			<div id="div_subSectionEnter" class="div_subSection"
				rendered="#{opinionController.actionEnum.whatAction == opinionController.actionEnum.addAction
							|| opinionController.actionEnum.whatAction == opinionController.actionEnum.updateAction}">
				<ui:include src="_block/_enterOpinion.xhtml" />
			</div>
			<%@include
				file="/stylesheets/gestionnaire/opinion/_block/_proposition.jsp"%>
			<div id="div_subSection" class="div_subSection">
				<h:form id="seeAvisForm">
					<div id="blockFormAdresse" class="blockForm">
						<div styleClass="blockButton"
							rendered="#{opinionController.actionEnum.whatAction == opinionController.actionEnum.emptyAction}">
							<h:panelGroup>
								<p:commandButton value="#{msgs['FIELD_LABEL.PROPOSITION']}"
									immediate="true"
									action="#{opinionController.addProposition}"/>
								<p:commandButton value="#{msgs['AVIS.BUTTON.APPEL']}"
									 immediate="true"
									 action="#{opinionController.goAddAvisAppel}"/>
								<p:commandButton value="#{msgs['_.BUTTON.ADD']}"
									 immediate="true"
									 action="#{opinionController.goAddAvis}"/>
								<p:commandButton value="#{msgs['_.BUTTON.BACK']}"
										immediate="true"
										action="#{opinionController.goBackOpinions}"/>
							</h:panelGroup>
						</div>
						<p:dataTable var="avisPojo" value="#{opinionController.listAvisPojo}"
							styleClass="paginatorData" alternateColors="true">
							<p:column>
								<f:facet name="header">
									<h:outputText value="#{msgs['AVIS.LABEL_DECISION']}" />
								</f:facet>
								<h:outputText value="#{avisPojo.avis.result.libelle}"/>
							</p:column>
							<p:column rendered="#{opinionController.indVoeuxPojo.isUsingLC}">
								<f:facet name="header">
									<h:outputText value="#{msgs['AVIS.RANG']}" />
								</f:facet>
								<h:outputText value="#{avisPojo.avis.rang}"/>
							</p:column>
							<p:column>
								<f:facet name="header">
									<h:outputText value="#{msgs['AVIS.COMM_MOTIV']}" />
								</f:facet>
								<h:outputText value="#{avisPojo.shortCommentaireMotiv}" />
								<t:popup styleClass="containerPopup" style="width:350px;"
									closePopupOnExitingElement="true"
									closePopupOnExitingPopup="true" displayAtDistanceX="-50"
									displayAtDistanceY="0"
									rendered="#{avisPojo.isShortCommentaireMotiv}">
									<p:graphicImage url="/media/images/informationSmall.png"
										style="cursor:pointer;" />
									<f:facet name="popup">
										<h:panelGroup>
											<h:panelGrid columns="1">
												<h:outputText styleClass="titrePopupAide"
													value="#{msgs['FIELD_LABEL.LIBELLE']}" />
												<h:outputText styleClass="libellesAide"
													value="#{avisPojo.commentaireMotiv}" />
											</h:panelGrid>
										</h:panelGroup>
									</f:facet>
								</t:popup>
							</p:column>
							<p:column>
								<f:facet name="header">
									<h:outputText value="#{msgs['AVIS.DATE_CREATION']}" />
								</f:facet>
								<h:outputText value="#{avisPojo.avis.dateCreaEnr}">
									<f:convertDateTime pattern="dd/MM/yyyy HH:mm"
										timeZone="#{sessionController.timezone}" />
								</h:outputText>
							</p:column>
							<p:column>
								<f:facet name="header">
									<h:outputText value="#{msgs['AVIS.DATE_MODIF']}" />
								</f:facet>
								<h:outputText value="#{avisPojo.avis.dateModifEnr}">
									<f:convertDateTime pattern="dd/MM/yyyy HH:mm"
										timeZone="#{sessionController.timezone}" />
								</h:outputText>
							</p:column>
							<p:column>
								<f:facet name="header">
									<h:outputText value="#{msgs['AVIS.APPEL']}" />
								</f:facet>
								<p:graphicImage url="/media/images/check2.gif" 
									rendered="#{avisPojo.avis.appel}"/>
								<p:graphicImage url="/media/images/check0.gif" 
									rendered="#{!avisPojo.avis.appel}"/>
							</p:column>
							<p:column>
								<f:facet name="header">
									<h:outputText value="#{msgs['AVIS.VALIDATE']}" />
								</f:facet>
								<p:graphicImage url="/media/images/check2.gif" 
									rendered="#{avisPojo.avis.validation}"/>
								<p:graphicImage url="/media/images/check0.gif" 
									rendered="#{!avisPojo.avis.validation}"/>
							</p:column>
							<p:column>
								<f:facet name="header">
									<h:outputText value="#{msgs['FIELD_LABEL.IN_USE']}" />
								</f:facet>
								<p:graphicImage url="/media/images/check2.gif" 
									rendered="#{avisPojo.avis.temoinEnService}"/>
								<p:graphicImage url="/media/images/check0.gif" 
									rendered="#{!avisPojo.avis.temoinEnService}"/>
							</p:column>
							<p:column styleClass="buttonTD">
								<p:commandButton image="/media/images/update.png"
									immediate="true"
									styleClass="form-button-image" title="#{msgs['BUTTON.UPDATE']}" 
									action="#{opinionController.goUpdateAvis}"
									rendered="#{opinionController.actionEnum.whatAction == opinionController.actionEnum.emptyAction
											&& managedAccess.updateAuthorized && avisPojo.avis.temoinEnService
											&& !(avisPojo.avis.result.isFinal && avisPojo.avis.validation)}">
									<f:setPropertyActionListener value="#{avisPojo.avis}" target="#{opinionController.avis}" />
								</p:commandButton>
							</p:column>
						</p:dataTable>
						
					</div>
					<br />
					<br />
					<br />
				</h:form>
			</div>
		</div>
		
		<script type="text/javascript">
		highlightChildrenLiTags('navigationHeader:navigation');
		highlightChildrenLiTags('navigationFooter:navigation');
	</script>
	</ui:define>
</ui:composition>
